<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Advanced Queries &middot; Data wRangling for Ecologists
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/wRangling-Ecology/public/css/poole.css">
  <link rel="stylesheet" href="/wRangling-Ecology/public/css/syntax.css">
  <link rel="stylesheet" href="/wRangling-Ecology/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/wRangling-Ecology/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/wRangling-Ecology/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-68320080-1', 'auto');
    ga('send', 'pageview');

  </script>

</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar">
    <div class="sidebar-about">
      <h1>
        <a href="/wRangling-Ecology/">
          Data wRangling for Ecologists
        </a>
      </h1>
      <p class="lead">Using data science tools for exploration, analysis, and research</p>
    </div>
    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/wRangling-Ecology/nav/getting-started"><i class="fa fa-play fa-fw"></i> Getting Started</a>
      <a class="sidebar-nav-item" href="/wRangling-Ecology/nav/course-materials"><i class="fa fa-briefcase fa-fw"></i> Course Materials</a>
      <a class="sidebar-nav-item" href="/wRangling-Ecology/schedule"><i class="fa fa-calendar fa-fw"></i> Schedule</a>
      <a class="sidebar-nav-item" href="/wRangling-Ecology/nav/about"><i class="fa fa-user fa-fw"></i> About / Contact Us</a>
      <a class="sidebar-nav-item" href="/wRangling-Ecology/in-class-feedback"><i class="fa fa-bullhorn fa-fw"></i> In-class Feedback</a>
    </nav>

    <p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/wRangling-Ecology/public/cc-by-80x15.png" /></a></p>
  </div>
</div>


    <div class="content container">
      <div class="page-header">
  <h1 class="page-title">Advanced Queries</h1>
  <h2 class="page-subtitle">Notes</h2>
  <hr width="75%">
</div>

<div class="page-content">
  <p>So far weâ€™ve learned about basic SELECT queries in Access,
but there are several other kinds.</p>

<h2 id="make-table-queries">Make table queries</h2>

<p>One thing we often want to do is make new tables using queries.
This is particularly useful for restructuring an existing database.</p>

<ol>
  <li>Make the query that produces the results you want</li>
  <li>On the <strong>Design</strong> tab change the <strong>Query Type</strong> to <strong>Make Table</strong></li>
  <li>Give the new table a name</li>
  <li>Press <strong>Run</strong></li>
  <li>Click <strong>Yes</strong></li>
</ol>

<h2 id="append-queries">Append queries</h2>

<p>If we want to add new data to an existing table, we can use an Append query.
This is useful for carefully adding new data,
because we can import the data into a temporary table,
make sure everything is good, and then add it with to the main table.</p>

<ol>
  <li>Make the query that produces the results you want to add to the existing table</li>
  <li>On the <strong>Design</strong> tab change the <strong>Query Type</strong> to <strong>Append</strong></li>
  <li>Tell Access what table you want to append the data to</li>
  <li>Click <strong>Run</strong></li>
  <li>Click <strong>Yes</strong></li>
</ol>

<h2 id="update-queries">Update queries</h2>

<p>If we want to change the data in an existing table we can use an Update query.</p>

<ol>
  <li>Create a new query</li>
  <li>On the <strong>Design</strong> tab change the <strong>Query Type</strong> to <strong>Update</strong></li>
  <li>Select the fields you want to change</li>
  <li>Indicate the value that those fields should be changed to in the <strong>Update To</strong> box</li>
  <li>Add the Criteria under which to make the change</li>
  <li>Click <strong>Run</strong></li>
  <li>Click <strong>Yes</strong></li>
</ol>

<p>The combined Criteria apply to all fields and do not need to include the field(s) being updated.</p>

<h3 id="example">Example</h3>

<p>If we realized that all individuals identified as DM between 1990 and 1992
were actually DO we could do an update query to correct this.</p>

<h2 id="crosstab-queries">Crosstab queries</h2>

<p>Sometimes we want classic crosstab data for analysis,
where the rows group by one variable, the columns group by another variable,
and the cells contain values for each unique combination of row and column values.
For example, a common example of this in biology is a Site by Species matrix,
where the rows are different species, the columns are different sites,
and the values are counts.</p>

<ol>
  <li>Create a new query</li>
  <li>On the <strong>Design</strong> tab change the <strong>Query Type</strong> to <strong>Crosstab</strong></li>
  <li>Add the grouping fields for the rows and columns and the value field</li>
  <li>In the <strong>Total</strong> row indicate which fields to group by and how to calculate
the appropriate value (i.e., is it a Count, a Sum, etc.)</li>
  <li>In the <strong>Crosstab</strong> row indicate which field is the Column Heading,
which is the Row Heading, and which is the value</li>
</ol>

<h3 id="example-1">Example</h3>
<ul>
  <li>Portal Species by Plots matrix</li>
  <li>Then change from Count to Biomass</li>
</ul>

</div>

    </div>

  </body>
</html>
